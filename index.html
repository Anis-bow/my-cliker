<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>bachoi 17 maktab | Premium</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --accent: #f39c12;
            --bg: #0f172a;
            --glass: rgba(255, 255, 255, 0.1);
        }

        body { 
            font-family: 'Poppins', sans-serif; 
            background: radial-gradient(circle at top, #1e293b, #0f172a); 
            color: white; margin: 0; 
            display: flex; flex-direction: column; align-items: center; 
            height: 100vh; overflow: hidden; 
            -webkit-tap-highlight-color: transparent;
        }

        /* –ó–∞—â–∏—Ç–∞ */
        * { -webkit-user-select: none; user-select: none; -webkit-touch-callout: none; box-sizing: border-box; }

        #ui-top { text-align: center; margin-top: 30px; z-index: 10; width: 100%; animation: fadeInDown 0.8s ease; }
        #score-container { font-size: 4rem; font-weight: 900; letter-spacing: -2px; text-shadow: 0 0 20px rgba(52, 152, 219, 0.5); margin-bottom: 5px; }
        #power-info { font-size: 1rem; color: #94a3b8; background: var(--glass); padding: 5px 15px; border-radius: 20px; display: inline-block; }

        #game-area { flex: 1; display: flex; align-items: center; justify-content: center; width: 100%; position: relative; }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç –≤—ã–ª–µ—Ç–∞—é—â–∏—Ö —Ü–∏—Ñ—Ä */
        .click-particle {
            position: absolute; color: var(--primary); font-weight: bold; font-size: 1.5rem;
            pointer-events: none; animation: floatUp 0.8s forwards; z-index: 100;
        }

        #click-btn { 
            width: 240px; height: 240px; border-radius: 50%; border: 10px solid var(--glass); 
            box-shadow: 0 0 50px rgba(52, 152, 219, 0.2); cursor: pointer; object-fit: cover; 
            transition: transform 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        #click-btn:active { transform: scale(0.9); }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; 
            z-index: 100; backdrop-filter: blur(10px); animation: fadeIn 0.3s ease;
        }
        .modal-content { 
            background: rgba(30, 41, 59, 0.95); width: 92%; max-width: 420px; 
            border-radius: 30px; padding: 25px; position: relative; height: 75vh; 
            display: flex; flex-direction: column; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
        }

        #lb-content, #chat-content, .shop-grid { 
            flex: 1; overflow-y: auto; padding: 15px; background: rgba(0,0,0,0.2); 
            border-radius: 20px; border: 1px solid rgba(255,255,255,0.05);
        }

        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .shop-item { 
            background: var(--glass); padding: 15px; border-radius: 20px; text-align: center; 
            transition: 0.3s; border: 1px solid transparent;
        }
        .shop-item:hover { border-color: var(--primary); transform: translateY(-3px); }
        .shop-item img { width: 70px; height: 70px; margin-bottom: 10px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3)); }
        .buy-btn { 
            background: linear-gradient(135deg, var(--secondary), #27ae60); color: white; 
            border: none; padding: 10px; border-radius: 12px; cursor: pointer; width: 100%; 
            font-weight: bold; margin-top: 10px; box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        nav { 
            position: fixed; bottom: 20px; width: 90%; max-width: 400px; height: 70px; 
            background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(15px);
            display: flex; border-radius: 25px; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 50;
        }
        .nav-item { 
            flex: 1; display: flex; flex-direction: column; align-items: center; 
            justify-content: center; font-size: 0.7rem; font-weight: bold; color: #64748b; transition: 0.3s;
        }
        .nav-item.active { color: var(--primary); transform: translateY(-5px); }
        .nav-item b { font-size: 1.1rem; }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="ui-top">
        <div id="score-container"><span id="coins">0</span> üíµ</div>
        <div id="power-info">‚ö° Power: <span id="current-power">1</span> / 5</div>
        <div id="user-info" onclick="changeName()" style="margin-top:10px; font-size:0.8rem; opacity:0.6; cursor:pointer;">–ò–≥—Ä–æ–∫: <span id="display-name">...</span> ‚úé</div>
    </div>

    <div id="game-area">
        <img id="click-btn" src="gerb.png" alt="Main" draggable="false">
    </div>

    <div id="modal-top" class="modal"><div class="modal-content"><span class="close-btn" onclick="closeModals()">√ó</span><h2 style="text-align:center">üèÜ Leaders</h2><div id="lb-content"></div></div></div>

    <div id="modal-chat" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModals()">√ó</span>
            <h2 style="text-align:center">üí¨ Global Chat</h2>
            <div id="chat-content"></div>
            <div style="display:flex; gap:10px; margin-top:15px;">
                <input type="text" id="chat-input" placeholder="Say something..." style="flex:1; background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.1); color:white; padding:12px; border-radius:15px; outline:none;">
                <button onclick="sendMsg()" style="background:var(--primary); border:none; width:50px; border-radius:15px; color:white; font-size:1.2rem; cursor:pointer">‚û§</button>
            </div>
        </div>
    </div>

    <div id="modal-shop" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModals()">√ó</span>
            <h2 style="text-align:center">üéÅ Shop</h2>
            <div class="shop-grid">
                <div class="shop-item"><img src="png-transparent-emojipedia-heart-ribbon-emoticon-emoji-love-ribbon-heart.png"><h4>Heart</h4><button class="buy-btn" onclick="exchangeGift('–°–µ—Ä–¥–µ—á–∫–æ', 20000)">20k</button></div>
                <div class="shop-item"><img src="i (5).webp"><h4>Bear</h4><button class="buy-btn" onclick="exchangeGift('–ú–∏—à–∫–∞', 20000)">20k</button></div>
                <div class="shop-item"><img src="538e404bde2a5b9680bf486cdc6ea4b4.jpg"><h4>Rose</h4><button class="buy-btn" onclick="exchangeGift('–†–æ–∑–∞', 35000)">35k</button></div>
                <div class="shop-item"><img src="default.png"><h4>Box</h4><button class="buy-btn" onclick="exchangeGift('–ü–æ–¥–∞—Ä–æ–∫', 35000)">35k</button></div>
            </div>
        </div>
    </div>

    <nav>
        <div class="nav-item active" id="nav-home" onclick="closeModals()">üè†<br>PLAY</div>
        <div class="nav-item" id="nav-top" onclick="openModal('modal-top')">üèÜ<br>TOP</div>
        <div class="nav-item" id="nav-chat" onclick="openModal('modal-chat')">üí¨<br>CHAT</div>
        <div class="nav-item" id="nav-shop" onclick="openModal('modal-shop')">üéÅ<br>SHOP</div>
        <div class="nav-item" onclick="buyBoost()" style="color: var(--accent);">‚ö°<br><b id="boost-label">100</b></div>
    </nav>

    <script>
        const DB_URL = "https://clikercomee-default-rtdb.firebaseio.com"; 
        let userName = localStorage.getItem('p_name') || prompt("Your Name:") || "User" + Math.floor(Math.random()*100);
        localStorage.setItem('p_name', userName);
        
        let count = parseInt(localStorage.getItem('p_coins')) || 0;
        let power = parseInt(localStorage.getItem('p_power')) || 1;
        let needsSync = false;
        const boostPrices = [0, 100, 500, 1000, 1500, 2000];

        function updateUI() {
            document.getElementById('coins').innerText = count.toLocaleString();
            document.getElementById('current-power').innerText = power;
            document.getElementById('display-name').innerText = userName;
            document.getElementById('boost-label').innerText = power >= 5 ? "MAX" : boostPrices[power];
        }

        function createParticle(e) {
            const particle = document.createElement('div');
            particle.className = 'click-particle';
            particle.innerText = `+${power}`;
            particle.style.left = `${e.clientX || e.touches[0].clientX}px`;
            particle.style.top = `${e.clientY || e.touches[0].clientY}px`;
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 800);
        }

        document.getElementById('click-btn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            count += power; needsSync = true;
            updateUI();
            createParticle(e);
        });

        async function sync() {
            if(!needsSync) return;
            await fetch(`${DB_URL}/players/${userName}.json`, { method: 'PUT', body: JSON.stringify({ score: count, power: power }) });
            needsSync = false;
        }

        function buyBoost() {
            if (power >= 5) return;
            if (count >= boostPrices[power]) {
                count -= boostPrices[power]; power++; needsSync = true; updateUI();
            } else { alert("Not enough coins!"); }
        }

        async function loadLB() {
            const res = await fetch(`${DB_URL}/players.json`);
            const data = await res.json();
            const box = document.getElementById('lb-content'); box.innerHTML = '';
            Object.entries(data).sort((a,b) => b[1].score - a[1].score).slice(0,10).forEach((p, i) => {
                box.innerHTML += `<div style="display:flex; justify-content:space-between; padding:12px; background:rgba(255,255,255,0.05); border-radius:15px; margin-bottom:8px;">
                    <span><b>${i+1}.</b> ${p[0]} <small style="color:var(--primary)">(LVL ${p[1].power})</small></span>
                    <b>${p[1].score.toLocaleString()}</b></div>`;
            });
        }

        async function sendMsg() {
            const input = document.getElementById('chat-input');
            const txt = input.value.trim(); if(!txt) return; input.value = '';
            await fetch(`${DB_URL}/chat.json`, { method: 'POST', body: JSON.stringify({ user: userName, msg: txt, time: Date.now() }) });
            loadChat();
        }

        async function loadChat() {
            const res = await fetch(`${DB_URL}/chat.json`);
            const data = await res.json();
            const box = document.getElementById('chat-content'); box.innerHTML = '';
            Object.values(data).sort((a,b) => a.time - b.time).slice(-30).forEach(m => {
                const my = m.user === userName;
                box.innerHTML += `<div style="padding:10px; border-radius:15px; margin-bottom:8px; max-width:80%; align-self:${my?'flex-end':'flex-start'}; background:${my?'var(--primary)':'rgba(255,255,255,0.1)'}">
                    <b style="font-size:0.7rem; display:block; opacity:0.7">${m.user}</b>${m.msg}</div>`;
            });
            box.scrollTop = box.scrollHeight;
        }

        function openModal(id) {
            closeModals();
            document.getElementById(id).style.display = 'flex';
            document.getElementById('nav-'+id.split('-')[1]).classList.add('active');
            if(id === 'modal-top') loadLB();
            if(id === 'modal-chat') loadChat();
        }

        function closeModals() {
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('nav-home').classList.add('active');
        }

        function changeName() {
            let n = prompt("Change name:", userName);
            if(n) { userName = n; localStorage.setItem('p_name', n); needsSync = true; updateUI(); }
        }

        updateUI();
        setInterval(sync, 3000);
        setInterval(() => { if(document.getElementById('modal-chat').style.display === 'flex') loadChat(); }, 3000);
    </script>
</body>
</html>
