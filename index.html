<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gerb Clicker: Hardcore</title>
    <style>
        :root { --p: #3498db; --s: #e74c3c; --g: #2ecc71; --dark: #0f172a; }
        body { font-family: 'Arial Black', sans-serif; background: var(--dark); color: white; margin: 0; overflow: hidden; display: flex; flex-direction: column; align-items: center; height: 100vh; }
        * { -webkit-user-select: none; user-select: none; box-sizing: border-box; }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å: –°—Ç–∞—Ç—ã */
        #stats-bar { width: 100%; padding: 20px; background: rgba(255,255,255,0.05); display: flex; justify-content: space-around; font-size: 0.9rem; text-align: center; }
        .stat-box b { display: block; font-size: 1.4rem; color: var(--p); }
        
        /* –ü–æ–ª–æ—Å–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏ */
        #energy-container { width: 80%; height: 10px; background: #334155; border-radius: 5px; margin-top: 10px; overflow: hidden; }
        #energy-bar { width: 100%; height: 100%; background: linear-gradient(90deg, #f1c40f, #e67e22); transition: width 0.3s; }

        /* –ì–ª–∞–≤–Ω–∞—è –∑–æ–Ω–∞ */
        #game-area { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; width: 100%; }
        #coins-display { font-size: 4rem; text-shadow: 0 0 30px var(--p); margin-bottom: 20px; }
        
        #click-btn { 
            width: 250px; height: 250px; border-radius: 50%; border: 10px solid rgba(255,255,255,0.1);
            cursor: pointer; transition: transform 0.05s; position: relative; z-index: 5;
        }
        #click-btn:active { transform: scale(0.92); }

        /* –õ–µ—Ç–∞—é—â–∏–π —É—Ä–æ–Ω */
        .pop { position: absolute; font-weight: 900; pointer-events: none; animation: fly 0.6s forwards; z-index: 10; }
        @keyframes fly { 0% { opacity:1; transform:translateY(0) scale(1.5); } 100% { opacity:0; transform:translateY(-150px) scale(1); } }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        nav { position: fixed; bottom: 0; width: 100%; height: 80px; background: #1e293b; display: flex; border-top: 2px solid var(--p); }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 0.7rem; cursor: pointer; color: #94a3b8; }
        .nav-item.active { color: white; background: rgba(52, 152, 219, 0.2); }

        /* –ú–æ–¥–∞–ª–∫–∏ */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 100; backdrop-filter: blur(10px); }
        .modal-content { width: 90%; max-width: 400px; background: #1e293b; border-radius: 20px; padding: 20px; height: 70vh; display: flex; flex-direction: column; }
        .list { flex: 1; overflow-y: auto; margin: 15px 0; }
        .item { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .up-btn { background: var(--g); border: none; color: white; padding: 8px 15px; border-radius: 8px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="stats-bar">
        <div class="stat-box">–î–æ—Ö–æ–¥/—Å–µ–∫<b><span id="auto-val">0</span></b></div>
        <div class="stat-box">–≠–Ω–µ—Ä–≥–∏—è<b><span id="en-text">100/100</span></b></div>
        <div class="stat-box">–ö—Ä–∏—Ç %<b><span id="crit-val">10%</span></b></div>
    </div>
    <div id="energy-container"><div id="energy-bar"></div></div>

    <div id="game-area">
        <div id="coins-display">0 üíµ</div>
        <img id="click-btn" src="gerb.png" draggable="false">
    </div>

    <div id="modal-upgrades" class="modal">
        <div class="modal-content">
            <span onclick="closeModals()" style="text-align:right; cursor:pointer">‚úñ</span>
            <h2>üõ† –£–õ–£–ß–®–ï–ù–ò–Ø</h2>
            <div class="list">
                <div class="item">
                    <div><b>–°–∏–ª–∞ –∫–ª–∏–∫–∞</b><br><small id="p-lvl">Lvl 1</small></div>
                    <button class="up-btn" onclick="upgrade('power')">üí∞ <span id="p-cost">100</span></button>
                </div>
                <div class="item">
                    <div><b>–ê–≤—Ç–æ-–∫–ª–∏–∫–µ—Ä</b><br><small id="a-lvl">Lvl 0</small></div>
                    <button class="up-btn" onclick="upgrade('auto')">üí∞ <span id="a-cost">250</span></button>
                </div>
                <div class="item">
                    <div><b>–ú–∞–∫—Å. –≠–Ω–µ—Ä–≥–∏—è</b><br><small id="e-lvl">Lvl 1</small></div>
                    <button class="up-btn" onclick="upgrade('energy')">üí∞ <span id="e-cost">150</span></button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-top" class="modal"><div class="modal-content"><span onclick="closeModals()" style="text-align:right; cursor:pointer">‚úñ</span><h2>üèÜ –õ–ò–î–ï–†–´</h2><div id="lb-content" class="list"></div></div></div>

    <nav>
        <div class="nav-item active" onclick="closeModals()">üè†<br>–ò–ì–†–ê</div>
        <div class="nav-item" onclick="openModal('modal-upgrades')">üõ†<br>–°–ö–õ–ò–ù–´</div>
        <div class="nav-item" onclick="openModal('modal-top')">üèÜ<br>–¢–û–ü</div>
        <div class="nav-item" onclick="alert('–û–±–º–µ–Ω –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">üéÅ<br>–û–ë–ú–ï–ù</div>
    </nav>

    <script>
        const DB_URL = "https://clikercomee-default-rtdb.firebaseio.com";
        let user = localStorage.getItem('p_user') || "User" + Math.floor(Math.random()*1000);
        localStorage.setItem('p_user', user);

        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        let coins = 0, power = 1, auto = 0, energy = 100, maxEnergy = 100;
        let pLvl = 1, aLvl = 0, eLvl = 1;

        function updateUI() {
            document.getElementById('coins-display').innerText = Math.floor(coins).toLocaleString() + " üíµ";
            document.getElementById('en-text').innerText = `${Math.floor(energy)}/${maxEnergy}`;
            document.getElementById('energy-bar').style.width = (energy / maxEnergy * 100) + "%";
            document.getElementById('auto-val').innerText = auto;
            
            document.getElementById('p-lvl').innerText = `Lvl ${pLvl}`;
            document.getElementById('p-cost').innerText = Math.floor(100 * Math.pow(1.5, pLvl));
            document.getElementById('a-lvl').innerText = `Lvl ${aLvl}`;
            document.getElementById('a-cost').innerText = Math.floor(250 * Math.pow(1.6, aLvl));
            document.getElementById('e-lvl').innerText = `Lvl ${eLvl}`;
            document.getElementById('e-cost').innerText = Math.floor(150 * Math.pow(1.4, eLvl));
        }

        // –õ–æ–≥–∏–∫–∞ –∫–ª–∏–∫–∞
        function clickAction(e) {
            if (energy < 1) return;
            
            let isCrit = Math.random() < 0.1; // 10% —à–∞–Ω—Å –∫—Ä–∏—Ç–∞
            let amount = isCrit ? power * 5 : power;
            
            coins += amount;
            energy -= 1;
            
            showPop(e, (isCrit ? "üî• CRIT +" : "+") + amount, isCrit);
            updateUI();
        }

        function showPop(e, text, crit) {
            const pop = document.createElement('div');
            pop.className = 'pop';
            pop.innerText = text;
            pop.style.color = crit ? "#f1c40f" : "#3498db";
            pop.style.left = (e.clientX || e.touches[0].clientX) + "px";
            pop.style.top = (e.clientY || e.touches[0].clientY) + "px";
            document.body.appendChild(pop);
            setTimeout(() => pop.remove(), 600);
        }

        // –ü—Ä–æ–∫–∞—á–∫–∞
        function upgrade(type) {
            if (type === 'power') {
                let cost = Math.floor(100 * Math.pow(1.5, pLvl));
                if (coins >= cost) { coins -= cost; pLvl++; power += 1.5; }
            } else if (type === 'auto') {
                let cost = Math.floor(250 * Math.pow(1.6, aLvl));
                if (coins >= cost) { coins -= cost; aLvl++; auto += 1; }
            } else if (type === 'energy') {
                let cost = Math.floor(150 * Math.pow(1.4, eLvl));
                if (coins >= cost) { coins -= cost; eLvl++; maxEnergy += 50; energy = maxEnergy; }
            }
            updateUI();
            saveData();
        }

        // –ê–≤—Ç–æ-–¥–æ—Ö–æ–¥ –∏ —Ä–µ–≥–µ–Ω —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(() => {
            coins += auto / 10;
            if (energy < maxEnergy) energy += 0.2;
            updateUI();
        }, 100);

        async function saveData() {
            await fetch(`${DB_URL}/players/${user}.json`, { 
                method: 'PUT', 
                body: JSON.stringify({ coins, power, auto, maxEnergy, pLvl, aLvl, eLvl }) 
            });
        }

        async function loadLB() {
            const res = await fetch(`${DB_URL}/players.json`);
            const data = await res.json();
            const box = document.getElementById('lb-content'); box.innerHTML = '';
            Object.entries(data).sort((a,b) => b[1].coins - a[1].coins).slice(0,10).forEach((p, i) => {
                box.innerHTML += `<div class="item"><span>${i+1}. ${p[0]}</span><b>${Math.floor(p[1].coins).toLocaleString()}</b></div>`;
            });
        }

        function openModal(id) { 
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
            document.getElementById(id).style.display = 'flex'; 
            if(id === 'modal-top') loadLB();
        }
        function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }

        const btn = document.getElementById('click-btn');
        btn.addEventListener('touchstart', (e) => { e.preventDefault(); clickAction(e); });
        btn.addEventListener('mousedown', (e) => clickAction(e));

        updateUI();
        setInterval(saveData, 10000);
    </script>
</body>
</html>
